
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyo.lib.events &#8212; Pyo 1.0.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/agogo.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-codeautolink.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/autoclasstoc.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="shortcut icon" href="../../../_static/E-PyoIcon.ico"/>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../../../index.html">Pyo 1.0.4 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="sidebar">
          
          <h3>Table of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">About pyo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../download.html">Installing pyo with pip</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../compiling.html">Compiling pyo from sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">Structure of the library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../winaudioinspect.html">Configuring the audio output (Windows)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../perftips.html">Improve performance of pyo programs</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Advanced tutorials</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
            </form>
          </div>

        </div>
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pyo.lib.events</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This submodule contains a set of tools to generate sequence of events.</span>

<span class="sd">The purpose of the Event framework is to allow the user to generate a</span>
<span class="sd">sequence of events with as few as possible parameters to specify.</span>

<span class="sd">:py:class:`Events` is the heart of the framework. An Events object computes</span>
<span class="sd">parameters, generally designed with event generator objects, builds the events</span>
<span class="sd">and plays the sequence.</span>

<span class="sd">See the Events framework examples in the documentation for different use cases.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Copyright 2019 Olivier Belanger</span>

<span class="sd">This file is part of pyo, a python module to help digital signal</span>
<span class="sd">processing script creation.</span>

<span class="sd">pyo is free software: you can redistribute it and/or modify</span>
<span class="sd">it under the terms of the GNU General Public License as published by</span>
<span class="sd">the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">(at your option) any later version.</span>

<span class="sd">pyo is distributed in the hope that it will be useful,</span>
<span class="sd">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">GNU General Public License for more details.</span>

<span class="sd">You should have received a copy of the GNU General Public License</span>
<span class="sd">along with pyo.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">._core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.pattern</span> <span class="kn">import</span> <span class="n">Pattern</span><span class="p">,</span> <span class="n">CallAfter</span>
<span class="kn">from</span> <span class="nn">.tableprocess</span> <span class="kn">import</span> <span class="n">TableRead</span>
<span class="kn">from</span> <span class="nn">.controls</span> <span class="kn">import</span> <span class="n">Fader</span><span class="p">,</span> <span class="n">Adsr</span>
<span class="kn">from</span> <span class="nn">.generators</span> <span class="kn">import</span> <span class="n">RCOsc</span>
<span class="kn">from</span> <span class="nn">.effects</span> <span class="kn">import</span> <span class="n">STRev</span>
<span class="kn">from</span> <span class="nn">.pan</span> <span class="kn">import</span> <span class="n">Pan</span>

<span class="n">inf</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">inf</span>

<span class="n">PYO_EVENT_OPERATOR_ADD</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">PYO_EVENT_OPERATOR_SUB</span> <span class="o">=</span> <span class="mi">1001</span>
<span class="n">PYO_EVENT_OPERATOR_MUL</span> <span class="o">=</span> <span class="mi">1002</span>
<span class="n">PYO_EVENT_OPERATOR_DIV</span> <span class="o">=</span> <span class="mi">1003</span>
<span class="n">PYO_EVENT_OPERATOR_POW</span> <span class="o">=</span> <span class="mi">1004</span>
<span class="n">PYO_EVENT_OPERATOR_MOD</span> <span class="o">=</span> <span class="mi">1005</span>
<span class="n">PYO_EVENT_OPERATOR_FLR</span> <span class="o">=</span> <span class="mi">1006</span>

<span class="n">PYO_EVENT_FILTER_FLOOR</span> <span class="o">=</span> <span class="mi">1100</span>
<span class="n">PYO_EVENT_FILTER_CEIL</span> <span class="o">=</span> <span class="mi">1101</span>
<span class="n">PYO_EVENT_FILTER_ROUND</span> <span class="o">=</span> <span class="mi">1102</span>
<span class="n">PYO_EVENT_FILTER_ABS</span> <span class="o">=</span> <span class="mi">1103</span>
<span class="n">PYO_EVENT_FILTER_SNAP</span> <span class="o">=</span> <span class="mi">1104</span>
<span class="n">PYO_EVENT_FILTER_DEVIATE</span> <span class="o">=</span> <span class="mi">1105</span>
<span class="n">PYO_EVENT_FILTER_CLIP</span> <span class="o">=</span> <span class="mi">1106</span>
<span class="n">PYO_EVENT_FILTER_SCALE</span> <span class="o">=</span> <span class="mi">1107</span>
<span class="n">PYO_EVENT_FILTER_RESCALE</span> <span class="o">=</span> <span class="mi">1108</span>
<span class="n">PYO_EVENT_FILTER_IFTRUE</span> <span class="o">=</span> <span class="mi">1109</span>

<span class="c1"># Utility functions</span>
<span class="c1">###################</span>
<span class="k">def</span> <span class="nf">degreeToMidiNote</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="s2">&quot;Converts an octave.degree notation to a MIDI note.&quot;</span>
    <span class="n">st</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">st</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">oct</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
            <span class="n">deg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">oct</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">deg</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">st</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">dotPos</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">dotPos</span> <span class="o">+</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span><span class="p">[:</span> <span class="n">dotPos</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">oct</span><span class="p">,</span> <span class="n">deg</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">deg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">0&quot;</span> <span class="o">%</span> <span class="n">deg</span>
            <span class="nb">oct</span><span class="p">,</span> <span class="n">deg</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">oct</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">deg</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">oct</span><span class="p">,</span> <span class="n">deg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="nb">oct</span> <span class="o">*</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">deg</span>


<span class="k">def</span> <span class="nf">midiNoteToDegree</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="s2">&quot;Converts a MIDI note to an octave.degree notation.&quot;</span>
    <span class="nb">oct</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>
    <span class="n">deg</span> <span class="o">=</span> <span class="n">value</span> <span class="o">%</span> <span class="mi">12</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">.</span><span class="si">%02d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">oct</span><span class="p">,</span> <span class="n">deg</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">getValueFromAttribute</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">currentDict</span><span class="p">,</span> <span class="n">valueIfNone</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="s2">&quot;Retrieve the value of an Events attribute, resolving its type.&quot;</span>
    <span class="n">attribute</span> <span class="o">=</span> <span class="n">master</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">returnValue</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">currentDict</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">currentDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">elif</span> <span class="n">attribute</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">returnValue</span> <span class="o">=</span> <span class="n">valueIfNone</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">EventKey</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">attribute</span><span class="o">.</span><span class="n">externalMaster</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attribute</span><span class="o">.</span><span class="n">getKey</span><span class="p">()</span> <span class="ow">in</span> <span class="n">currentDict</span><span class="p">:</span>
                <span class="n">returnValue</span> <span class="o">=</span> <span class="n">currentDict</span><span class="p">[</span><span class="n">attribute</span><span class="o">.</span><span class="n">getKey</span><span class="p">()]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">returnValue</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">attribute</span><span class="o">.</span><span class="n">getKey</span><span class="p">(),</span> <span class="n">currentDict</span><span class="p">)</span>
                <span class="n">currentDict</span><span class="p">[</span><span class="n">attribute</span><span class="o">.</span><span class="n">getKey</span><span class="p">()]</span> <span class="o">=</span> <span class="n">returnValue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">returnValue</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">externalMaster</span><span class="o">.</span><span class="n">getCurrentDict</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute</span><span class="o">.</span><span class="n">getKey</span><span class="p">(),</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
        <span class="n">returnValue</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">PyoTableObject</span><span class="p">):</span>
        <span class="n">returnValue</span> <span class="o">=</span> <span class="n">attribute</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">attribute</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
        <span class="n">returnValue</span> <span class="o">=</span> <span class="n">attribute</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

    <span class="n">currentDict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">returnValue</span>

    <span class="k">return</span> <span class="n">returnValue</span>


<span class="c1"># Utility classes</span>
<span class="c1">#################</span>
<span class="k">class</span> <span class="nc">MarkovGen</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lst</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originalList</span> <span class="o">=</span> <span class="n">lst</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temporaryList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playedNotes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startPlayback</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">startPlayback</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playedNotes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">originalList</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temporaryList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temporaryList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">originalList</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playedNotes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">originalList</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">originalList</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="p">:]</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">newValue</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probTable</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temporaryList</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">iord</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">playedNotes</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">playedNotes</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">iord</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
                    <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temporaryList</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="n">iord</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">probTable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temporaryList</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">])</span>

        <span class="n">newValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">probTable</span><span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">probTable</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">playedNotes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newValue</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newValue</span>

    <span class="k">def</span> <span class="nf">setOrder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">order</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startPlayback</span><span class="p">()</span>


<span class="c1"># Instruments</span>
<span class="c1">#############</span>
<div class="viewcode-block" id="EventInstrument"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventInstrument">[docs]</a><span class="k">class</span> <span class="nc">EventInstrument</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for an Events instrument. All attributes given to the Events</span>
<span class="sd">    object can be accessed as self.attribute_name inside the instrument.</span>

<span class="sd">    This base class constructs an envelope, named self.env, according to the</span>
<span class="sd">    value given to &#39;envelope&#39; (ex.: a LinTable object) or to &#39;attack&#39;, &#39;decay&#39;,</span>
<span class="sd">    &#39;sustain&#39; and &#39;release&#39; attributes of the event. The envelope is also</span>
<span class="sd">    scaled by the value of self.amp, defined by &#39;amp&#39;, &#39;db&#39; or &#39;midivel&#39;</span>
<span class="sd">    arguments of the Events object.</span>

<span class="sd">    This base class also creates a self.freq variable based on &#39;freq&#39;, &#39;degree&#39;</span>
<span class="sd">    or &#39;midinote&#39; arguments. This variable can be used in the instrument to</span>
<span class="sd">    control the pitch of the sound.</span>

<span class="sd">    All resources are automatically destroyed when the lifetime of the event</span>
<span class="sd">    is over. The lifetime of the event is set as self.dur + self.tail (&#39;dur&#39;</span>
<span class="sd">    or &#39;beat&#39; and &#39;tail&#39; arguments of Events).</span>

<span class="sd">    .. note::</span>

<span class="sd">        The user has almost no reason to instantiate an EventInstrument object</span>
<span class="sd">        himself. Instead, he should use it as a parent class for its own instruments.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">envelope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">TableRead</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">envelope</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dur</span><span class="p">,</span> <span class="n">mul</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">)</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">decay</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">Adsr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attack</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">decay</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sustain</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">,</span> <span class="n">dur</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dur</span><span class="p">,</span> <span class="n">mul</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">)</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">Fader</span><span class="p">(</span><span class="n">fadein</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attack</span><span class="p">,</span> <span class="n">fadeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="p">,</span> <span class="n">dur</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dur</span><span class="p">,</span> <span class="n">mul</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">amp</span><span class="p">)</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clearWhenDone</span> <span class="o">=</span> <span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearWhenDone</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dur</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">,</span> <span class="n">dur</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">removeFunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instanceId</span><span class="p">)</span></div>


<span class="k">class</span> <span class="nc">DefaultInstrument</span><span class="p">(</span><span class="n">EventInstrument</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The default instrument, playing a stereo RC oscillator, used when</span>
<span class="sd">    &#39;instr&#39; attribute is not defined for an Events object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="n">EventInstrument</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">osc</span> <span class="o">=</span> <span class="n">RCOsc</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span> <span class="n">sharp</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mul</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">osc</span><span class="o">.</span><span class="n">mix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">out</span><span class="p">()</span>


<span class="c1"># Event Scale</span>
<span class="c1">#############</span>
<div class="viewcode-block" id="EventScale"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventScale">[docs]</a><span class="k">class</span> <span class="nc">EventScale</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Musical scale builder.</span>

<span class="sd">    EventScale constructs a list of pitches according to its arguments.</span>

<span class="sd">    EventScale works similarly to list, ie. uses slicing with square brackets</span>
<span class="sd">    to access data, with the first element at index 0.</span>

<span class="sd">    It also accept the len() function, which returns the number of elements in</span>
<span class="sd">    the scale.</span>

<span class="sd">    :Args:</span>

<span class="sd">        root: str, optional</span>
<span class="sd">            The base note (fundamental) of the scale. Possible values are:</span>
<span class="sd">            &#39;C&#39;, &#39;C#&#39;, &#39;Db&#39;, &#39;D&#39;, &#39;D#&#39;, &#39;Eb&#39;, &#39;E&#39;, &#39;F&#39;, &#39;F#&#39;,</span>
<span class="sd">            &#39;Gb&#39;, &#39;G&#39;, &#39;G#&#39;, &#39;Ab&#39;, &#39;A&#39;, &#39;A#&#39;, &#39;Bb&#39;, &#39;B&#39;.</span>
<span class="sd">            Defaults to &#39;C&#39;.</span>
<span class="sd">        scale: str, optional</span>
<span class="sd">            The scale name to construct. Possible scales are:</span>
<span class="sd">            &#39;major&#39;, &#39;minorH&#39;, &#39;minorM&#39;, &#39;ionian&#39;, &#39;dorian&#39;, &#39;phrygian&#39;,</span>
<span class="sd">            &#39;lydian&#39;, &#39;mixolydian&#39;, &#39;aeolian&#39;, &#39;locrian&#39;, &#39;wholeTone&#39;,</span>
<span class="sd">            &#39;majorPenta&#39;, &#39;minorPenta&#39;, &#39;egyptian&#39;, &#39;majorBlues&#39;, &#39;minorBlues&#39;,</span>
<span class="sd">            &#39;minorHungarian&#39;.</span>
<span class="sd">            Defaults to &#39;major&#39;.</span>
<span class="sd">        first: int, optional</span>
<span class="sd">            The first octave of the generated scale, in multiple of 12. A value</span>
<span class="sd">            of 4, for a root of &#39;C&#39; means the first note of the scale will be 48.</span>
<span class="sd">            Defaults to 4.</span>
<span class="sd">        octaves: int, optional</span>
<span class="sd">            The number of octaves in the generated scale. Defaults to 2.</span>
<span class="sd">        type: int, optional</span>
<span class="sd">            The unit type in which the values are stored. Possible types are:</span>
<span class="sd">                0: MIDI note</span>
<span class="sd">                1: Hertz</span>
<span class="sd">                2: octave.degree notation (MIDI note 48 is 4.00 in octave.degrees)</span>

<span class="sd">    .. note::</span>

<span class="sd">        Here is a table showing the relationship between the three unit types that</span>
<span class="sd">        EventScale can handle.</span>

<span class="sd">        ======== ======== ========</span>
<span class="sd">        midi     oct.deg  Hertz</span>
<span class="sd">        ======== ======== ========</span>
<span class="sd">        48       4.00     130.81</span>
<span class="sd">        50       4.02     146.83</span>
<span class="sd">        52       4.04     164.81</span>
<span class="sd">        53       4.05     174.61</span>
<span class="sd">        55       4.07     195.99</span>
<span class="sd">        57       4.09     220.00</span>
<span class="sd">        59       4.11     246.94</span>
<span class="sd">        60       5.00     261.62</span>
<span class="sd">        ======== ======== ========</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; scl = EventScale(root=&quot;C&quot;, scale=&quot;major&quot;, first=4, octaves=2, type=2)</span>
<span class="sd">    &gt;&gt;&gt; e = Events(degree=EventDrunk(scl, maxStep=-2), beat=1/4., db=-6).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">first</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">octaves</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rootDegrees</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;C#&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;Db&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;D#&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;Eb&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;F#&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;Gb&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
            <span class="s2">&quot;G#&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;Ab&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>
            <span class="s2">&quot;A#&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;Bb&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
            <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scales</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;major&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
            <span class="s2">&quot;minorH&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
            <span class="s2">&quot;minorM&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
            <span class="s2">&quot;ionian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
            <span class="s2">&quot;dorian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;phrygian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;lydian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
            <span class="s2">&quot;mixolydian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;aeolian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;locrian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;wholeTone&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;majorPenta&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
            <span class="s2">&quot;minorPenta&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;egyptian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;majorBlues&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
            <span class="s2">&quot;minorBlues&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
            <span class="s2">&quot;minorHungarian&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="s2">&quot;c&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="s2">&quot;major&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_first</span> <span class="o">=</span> <span class="n">first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_octaves</span> <span class="o">=</span> <span class="n">octaves</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRoot</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_populate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[:]</span>
        <span class="n">degree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootDegrees</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootDegrees</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">])</span>
        <span class="n">currentScale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="p">[</span><span class="s2">&quot;major&quot;</span><span class="p">])</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">currentScale</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_octaves</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">octave</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_first</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="n">length</span><span class="p">))</span> <span class="o">*</span> <span class="mi">12</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">currentScale</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="n">length</span><span class="p">]</span> <span class="o">+</span> <span class="n">octave</span> <span class="o">+</span> <span class="n">degree</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">midiToHz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">midiNoteToDegree</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_length</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>

<div class="viewcode-block" id="EventScale.setRoot"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventScale.setRoot">[docs]</a>    <span class="k">def</span> <span class="nf">setRoot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace the `root` attribute and reconstruct the scale.</span>

<span class="sd">        :Args:</span>

<span class="sd">            x: string</span>
<span class="sd">                New `root` attribute.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rootDegrees</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EventScale: does not recognize root &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;... Using &#39;C&#39;.&quot;</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span></div>

<div class="viewcode-block" id="EventScale.setScale"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventScale.setScale">[docs]</a>    <span class="k">def</span> <span class="nf">setScale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace the `scale` attribute and reconstruct the scale.</span>

<span class="sd">        :Args:</span>

<span class="sd">            x: string</span>
<span class="sd">                New `scale` attribute.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EventScale: does not recognize scale &#39;</span><span class="si">%s</span><span class="s2">&#39;...&quot;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;... Using &#39;major&#39;.&quot;</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;major&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span></div>

<div class="viewcode-block" id="EventScale.setFirst"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventScale.setFirst">[docs]</a>    <span class="k">def</span> <span class="nf">setFirst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace the `first` attribute and reconstruct the scale.</span>

<span class="sd">        :Args:</span>

<span class="sd">            x: int</span>
<span class="sd">                New `int` attribute.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_first</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span></div>

<div class="viewcode-block" id="EventScale.setOctaves"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventScale.setOctaves">[docs]</a>    <span class="k">def</span> <span class="nf">setOctaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace the `octaves` attribute and reconstruct the scale.</span>

<span class="sd">        :Args:</span>

<span class="sd">            x: int</span>
<span class="sd">                New `octaves` attribute.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_octaves</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_octaves</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span></div>

<div class="viewcode-block" id="EventScale.setType"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventScale.setType">[docs]</a>    <span class="k">def</span> <span class="nf">setType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace the `type` attribute and reconstruct the scale.</span>

<span class="sd">        :Args:</span>

<span class="sd">            x: int</span>
<span class="sd">                New `type` attribute.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">root</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;string. Name of the fundamental key.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span>

    <span class="nd">@root</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">root</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRoot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;string. Name of scale to generate.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>

    <span class="nd">@scale</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setScale</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;int. First octave to generate.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first</span>

    <span class="nd">@first</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFirst</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;int. Number of octaves to generate.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_octaves</span>

    <span class="nd">@octaves</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">octaves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOctaves</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;int. Unit in which pitch values are stored.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>

    <span class="nd">@type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>


<span class="c1"># Event Generators</span>
<span class="c1">##################</span>
<div class="viewcode-block" id="EventGenerator"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator">[docs]</a><span class="k">class</span> <span class="nc">EventGenerator</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for all event generators.</span>

<span class="sd">    This class contains the common behaviours of all event generators.</span>

<span class="sd">    Each EventGenerator contains a particular algorithm that can produce a</span>
<span class="sd">    sequence of values triggered by an Events mecanism for one of its arguments.</span>

<span class="sd">    The EventGenerator allows very flexible control of the algorithm parameters.</span>
<span class="sd">    It can be a single value, another EventGenerator or an audio signal (PyoObject).</span>

<span class="sd">    Arithmetic operations are allowed on EventGenerator. An EventDummy is</span>
<span class="sd">    then created to apply the operation to each value produced by the generator.</span>

<span class="sd">    Arithmetic operators are:</span>

<span class="sd">        +: float, PyoObject or EventGenerator</span>
<span class="sd">            Addition.</span>
<span class="sd">        -: float, PyoObject or EventGenerator</span>
<span class="sd">            Substraction</span>
<span class="sd">        *: float, PyoObject or EventGenerator</span>
<span class="sd">            Multiplication</span>
<span class="sd">        /: float, PyoObject or EventGenerator</span>
<span class="sd">            Division</span>
<span class="sd">        %:  float, PyoObject or EventGenerator</span>
<span class="sd">            Modulo (remaining of the division)</span>
<span class="sd">        **: float, PyoObject or EventGenerator</span>
<span class="sd">            Exponent</span>
<span class="sd">        //: float, PyoObject or EventGenerator</span>
<span class="sd">            Quantizer (returns te nearest multiple of its argument)</span>

<span class="sd">    EventGenerator has a number of filter methods that can be applied on</span>
<span class="sd">    any generator to modify its output values. Available filter methods are:</span>

<span class="sd">        floor:</span>
<span class="sd">            Return an EventFilter computing the largest integer less than or</span>
<span class="sd">            equal to its input value.</span>
<span class="sd">        ceil:</span>
<span class="sd">            Return an EventFilter computing the smallest integer greater than</span>
<span class="sd">            or equal to its input value.</span>
<span class="sd">        round:</span>
<span class="sd">            Return an EventFilter computing the nearest integer to its input value.</span>
<span class="sd">        snap:</span>
<span class="sd">            Return an EventFilter which choose the nearest value of its input</span>
<span class="sd">            value in a list of choices.</span>
<span class="sd">        deviate:</span>
<span class="sd">            Return an EventFilter which randomly move, up or down, its input value.</span>
<span class="sd">        clip:</span>
<span class="sd">            Return an EventFilter which clips its input value between predefined</span>
<span class="sd">            limits.</span>
<span class="sd">        scale:</span>
<span class="sd">            Return an EventFilter which maps its input value, in the range 0 to 1,</span>
<span class="sd">            to an output range, with a scaling curve.</span>
<span class="sd">        rescale:</span>
<span class="sd">            Return an EventFilter which maps its input value, given in an input</span>
<span class="sd">            range, to an output range with a scaling curve.</span>
<span class="sd">        iftrue:</span>
<span class="sd">            Return an EventFilter which compares its input value to a comparison</span>
<span class="sd">            value and outputs it if the comparison is True.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_inspect_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="c1"># Inspect the value passed as a generator argument.</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">type</span><span class="p">([]),</span> <span class="nb">type</span><span class="p">(())]:</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="n">EventSeq</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)]:</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="n">EventSeq</span><span class="p">([</span><span class="n">generator</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">generator</span>

    <span class="k">def</span> <span class="nf">_inspect_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="c1"># Inspect the value passed as a values argument.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">values</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">values</span>

    <span class="k">def</span> <span class="nf">_inspect_occurrences</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">occurrences</span><span class="p">):</span>
        <span class="c1"># Inspect the value passed as an occurrences argument.</span>
        <span class="k">if</span> <span class="n">occurrences</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">occurrences</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">_internalGeneratorNextCall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Return the next value of an internal generator.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="p">,</span> <span class="n">EventKey</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">needToResetTarget</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">needToResetTarget</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">getKey</span><span class="p">()]</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">getKey</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">getCurrentDict</span><span class="p">():</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">getCurrentDict</span><span class="p">()[</span><span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">getKey</span><span class="p">()]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">getKey</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">getCurrentDict</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># Final check of the value produced by the generator in the next() method.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EventDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">PYO_EVENT_OPERATOR_ADD</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EventDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">PYO_EVENT_OPERATOR_SUB</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EventDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">PYO_EVENT_OPERATOR_MUL</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EventDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">PYO_EVENT_OPERATOR_DIV</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EventDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">PYO_EVENT_OPERATOR_DIV</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EventDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">PYO_EVENT_OPERATOR_POW</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EventDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">PYO_EVENT_OPERATOR_MOD</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">):</span>
        <span class="n">generator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">EventDummy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="n">PYO_EVENT_OPERATOR_FLR</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">):</span>
        <span class="c1"># Keep a reference of the master player (an Events object).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">master</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Return a deep copy of this generator (used in Events.events()).</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Reset the generator to its init state. Implemented in child objects.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Internally called to produce the next value. Implemented in child objects.</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">resetEmbeddedGenerator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Recursively resets embedded generators. Used when starting a sequence.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">resetEmbeddedGenerator</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

<div class="viewcode-block" id="EventGenerator.floor"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.floor">[docs]</a>    <span class="k">def</span> <span class="nf">floor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter computing the largest integer less than or</span>
<span class="sd">        equal to its input value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_FLOOR</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.ceil"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.ceil">[docs]</a>    <span class="k">def</span> <span class="nf">ceil</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter computing the smallest integer greater than or</span>
<span class="sd">        equal to its input value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_CEIL</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.round"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.round">[docs]</a>    <span class="k">def</span> <span class="nf">round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter computing the nearest integer to its input value.</span>
<span class="sd">        If two values are equally close, rounding is done toward the even choice.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_ROUND</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.abs"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.abs">[docs]</a>    <span class="k">def</span> <span class="nf">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter computing the absolute value of its input value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_ABS</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.snap"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.snap">[docs]</a>    <span class="k">def</span> <span class="nf">snap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choice</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter which choose the nearest value of its input value</span>
<span class="sd">        in the `choice` list.</span>

<span class="sd">        :Args:</span>

<span class="sd">            choice: list of floats</span>
<span class="sd">                Possible values to output.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_SNAP</span><span class="p">,</span> <span class="n">choice</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.deviate"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.deviate">[docs]</a>    <span class="k">def</span> <span class="nf">deviate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter which randomly move, up or down, its input value</span>
<span class="sd">        according to the argument `depth`, in percent.</span>

<span class="sd">        :Args:</span>

<span class="sd">            depth: float or PyoObject</span>
<span class="sd">                Percentage of deviation, between 0 and 100.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_DEVIATE</span><span class="p">,</span> <span class="n">depth</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.clip"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.clip">[docs]</a>    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter which clips its input value between the limits</span>
<span class="sd">        `mini` and `maxi`.</span>

<span class="sd">        :Args:</span>

<span class="sd">            mini: float or PyoObject</span>
<span class="sd">                Minimum output value.</span>
<span class="sd">            maxi: float or PyoObject</span>
<span class="sd">                Maximum output value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_CLIP</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.scale"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.scale">[docs]</a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="p">,</span> <span class="n">expon</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter which maps its input value, in the range 0 to 1,</span>
<span class="sd">        to an output range, with a scaling curve deternimed bu the `expon` value.</span>

<span class="sd">        :Args:</span>

<span class="sd">            mini: float or PyoObject</span>
<span class="sd">                Minimum output value.</span>
<span class="sd">            maxi: float or PyoObject</span>
<span class="sd">                Maximum output value.</span>
<span class="sd">            expon: float or PyoObject</span>
<span class="sd">                Exponent value, specifies the nature of the scaling curve.</span>
<span class="sd">                Values between 0 and 1 give a logarithmic curve, and values</span>
<span class="sd">                higher than 1 give an exponential curve.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_SCALE</span><span class="p">,</span> <span class="n">mini</span><span class="p">,</span> <span class="n">maxi</span><span class="p">,</span> <span class="n">expon</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.rescale"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.rescale">[docs]</a>    <span class="k">def</span> <span class="nf">rescale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inmin</span><span class="p">,</span> <span class="n">inmax</span><span class="p">,</span> <span class="n">outmin</span><span class="p">,</span> <span class="n">outmax</span><span class="p">,</span> <span class="n">expon</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter which maps its input value, in the range `inmin`</span>
<span class="sd">        to `inmax`, to an output range, `outmin` to `outmax`, with a scaling</span>
<span class="sd">        curve deternimed bu the `expon` value.</span>

<span class="sd">        :Args:</span>

<span class="sd">            inmin: float or PyoObject</span>
<span class="sd">                Minimum input value.</span>
<span class="sd">            inmax: float or PyoObject</span>
<span class="sd">                Maximum input value.</span>
<span class="sd">            outmin: float or PyoObject</span>
<span class="sd">                Minimum output value.</span>
<span class="sd">            outmax: float or PyoObject</span>
<span class="sd">                Maximum output value.</span>
<span class="sd">            expon: float or PyoObject</span>
<span class="sd">                Exponent value, specifies the nature of the scaling curve.</span>
<span class="sd">                Values between 0 and 1 give a logarithmic curve, and values</span>
<span class="sd">                higher than 1 give an exponential curve.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_RESCALE</span><span class="p">,</span> <span class="n">inmin</span><span class="p">,</span> <span class="n">inmax</span><span class="p">,</span> <span class="n">outmin</span><span class="p">,</span> <span class="n">outmax</span><span class="p">,</span> <span class="n">expon</span><span class="p">)</span></div>

<div class="viewcode-block" id="EventGenerator.iftrue"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventGenerator.iftrue">[docs]</a>    <span class="k">def</span> <span class="nf">iftrue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">comp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an EventFilter which compares its input value to the value</span>
<span class="sd">        given to `comp` argument, using the comparison operator `op`. If</span>
<span class="sd">        the result is True, the input value is sent to the output, otherwise,</span>
<span class="sd">        the last valid value is sent again.</span>

<span class="sd">        :Args:</span>

<span class="sd">            op: string</span>
<span class="sd">                The comparison operator. Valid operators are:</span>
<span class="sd">                &#39;&lt;&#39;, &#39;&lt;=&#39;, &#39;&gt;&#39;, &#39;&gt;=&#39;, &#39;==&#39;, &#39;!=&#39;.</span>
<span class="sd">            comp: float or PyoObject</span>
<span class="sd">                Comparison value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">EventFilter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PYO_EVENT_FILTER_IFTRUE</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="EventDummy"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventDummy">[docs]</a><span class="k">class</span> <span class="nc">EventDummy</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="s2">&quot;An EventGenerator created internally to handle arithmetic on Events.&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator1</span><span class="p">,</span> <span class="n">generator2</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator1</span> <span class="o">=</span> <span class="n">generator1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator2</span> <span class="o">=</span> <span class="n">generator2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator1</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
        <span class="n">v1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator1</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generator2</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator2</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generator2</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">v2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator2</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">v1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">v2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_OPERATOR_ADD</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v1</span> <span class="o">+</span> <span class="n">v2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_OPERATOR_SUB</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v1</span> <span class="o">-</span> <span class="n">v2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_OPERATOR_MUL</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v1</span> <span class="o">*</span> <span class="n">v2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_OPERATOR_DIV</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v1</span> <span class="o">/</span> <span class="n">v2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_OPERATOR_POW</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v1</span> <span class="o">**</span> <span class="n">v2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_OPERATOR_MOD</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">v1</span> <span class="o">%</span> <span class="n">v2</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_OPERATOR_FLR</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">v1</span> <span class="o">/</span> <span class="n">v2</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">v2</span></div>


<div class="viewcode-block" id="EventFilter"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventFilter">[docs]</a><span class="k">class</span> <span class="nc">EventFilter</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="s2">&quot;An EventGenerator created internally to handle simple filter on Events.&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">generator</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="n">generator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastValue</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
                <span class="n">arg</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_FLOOR</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_CEIL</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_ROUND</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_ABS</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_SNAP</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_DEVIATE</span><span class="p">:</span>
            <span class="n">depth</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.01</span>
            <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">depth</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">depth</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_CLIP</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_SCALE</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">**</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_RESCALE</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">**</span> <span class="n">args</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">value</span> <span class="o">*</span> <span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">PYO_EVENT_FILTER_IFTRUE</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span>
                <span class="n">istrue</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span>
                <span class="n">istrue</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
                <span class="n">istrue</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span>
                <span class="n">istrue</span> <span class="o">=</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;==&quot;</span><span class="p">:</span>
                <span class="n">istrue</span> <span class="o">=</span> <span class="n">value</span> <span class="o">==</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;!=&quot;</span><span class="p">:</span>
                <span class="n">istrue</span> <span class="o">=</span> <span class="n">value</span> <span class="o">!=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">istrue</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lastValue</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">return</span> <span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastValue</span></div>


<span class="c1">###################</span>
<div class="viewcode-block" id="EventKey"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventKey">[docs]</a><span class="k">class</span> <span class="nc">EventKey</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An EventGenerator that allow to retrieve the value of another parameter.</span>

<span class="sd">    EventKey returns the current value of another parameter of the Events</span>
<span class="sd">    object where it is used. From there, other processes can be applied</span>
<span class="sd">    (arithmetics, filters) to transform this value.</span>

<span class="sd">    EventKey can also read parameter values from another Events object when</span>
<span class="sd">    one is passed as `master` argument.</span>

<span class="sd">    :Args:</span>

<span class="sd">        key: string</span>
<span class="sd">            The name of the parameter to read from.</span>
<span class="sd">        master: Events, optional</span>
<span class="sd">            The Events object from which to read the parameter value. If</span>
<span class="sd">            None (the default), the current Events object is used.</span>


<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; # The lower the pitch value, the louder is the note.</span>
<span class="sd">    &gt;&gt;&gt; dbkey = EventKey(&quot;midinote&quot;).rescale(48,84,-3,-32,1)</span>
<span class="sd">    &gt;&gt;&gt; e = Events(midinote=list(range(48,84,2)), beat=1/4., db=dbkey).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needToResetTarget</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">externalMaster</span> <span class="o">=</span> <span class="n">master</span>

<div class="viewcode-block" id="EventKey.getKey"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventKey.getKey">[docs]</a>    <span class="k">def</span> <span class="nf">getKey</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the key, as a string, of the parameter to read from.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">key</span></div>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">needToResetTarget</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalMaster</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getKey</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">getCurrentDict</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">externalMaster</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getKey</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">externalMaster</span><span class="o">.</span><span class="n">getCurrentDict</span><span class="p">())</span></div>


<span class="c1">###################</span>
<div class="viewcode-block" id="EventSeq"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventSeq">[docs]</a><span class="k">class</span> <span class="nc">EventSeq</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plays through an entire list of values many times.</span>

<span class="sd">    EventSeq will loop over its list of values a number of times</span>
<span class="sd">    defined by the occurrences argument.</span>

<span class="sd">    :Args:</span>

<span class="sd">        values: EventScale or list</span>
<span class="sd">            List of values to loop over. Values in list can be floats,</span>
<span class="sd">            PyoObject or other EventGenerator.</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of times the sequence is entirely played in loop.</span>
<span class="sd">            Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    .. note::</span>

<span class="sd">        If an Events argument receives a single value or a list, it will be</span>
<span class="sd">        automatically converted to an EventSeq.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; e = Events(freq=EventSeq(midiToHz([60, 64, 67, 72])), beat=1/4.).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">occurrences</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">stopEventsWhenDone</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">stopEventsWhenDone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">completed</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internalGeneratorNextCall</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">completed</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">completed</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></div>


<div class="viewcode-block" id="EventSlide"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventSlide">[docs]</a><span class="k">class</span> <span class="nc">EventSlide</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plays overlapping segments from a list of values.</span>

<span class="sd">    EventSlide will play a segment of length `segment` from startpos,</span>
<span class="sd">    then another segment with a start position incremented by `step`,</span>
<span class="sd">    and so on.</span>

<span class="sd">    :Args:</span>

<span class="sd">        values: EventScale or list</span>
<span class="sd">            List of values to read. Values in list can be floats,</span>
<span class="sd">            PyoObject or other EventGenerator.</span>
<span class="sd">        segment: int, PyoObject or EventGenerator</span>
<span class="sd">            Number of values of each segment.</span>
<span class="sd">        step: int, PyoObject or EventGenerator</span>
<span class="sd">            How far to step the start of each segment from the previous. A</span>
<span class="sd">            negative value will step backward.</span>
<span class="sd">        startpos: int, optional</span>
<span class="sd">            The start position of the first segment. A negative value sets</span>
<span class="sd">            the position backward starting from the end of the list.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        wraparound: bool, optional</span>
<span class="sd">            If &#39;wraparound&#39; if True, indexing wraps around if goes past the</span>
<span class="sd">            beginning or the end of the list. If False, the playback stops</span>
<span class="sd">            if it goes outside the list bounds. Defaults to True.</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of entire segments to play. Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; scl = [5.00, 5.02, 5.03, 5.05, 5.07, 5.08, 5.10, 6.00]</span>
<span class="sd">    &gt;&gt;&gt; e = Events(degree=EventSlide(scl, 3, 1, 0), beat = 1/4., db = -6).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">segment</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">startpos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wraparound</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">occurrences</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">stopEventsWhenDone</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wraparound</span> <span class="o">=</span> <span class="n">wraparound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">stopEventsWhenDone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">segment</span> <span class="o">=</span> <span class="n">segment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastSegment</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">=</span> <span class="n">step</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastStep</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">startpos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startpos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="n">startpos</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startpos</span> <span class="o">=</span> <span class="n">startpos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">completed</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startpos</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segment</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">segment</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getStepValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastStep</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastStep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastStep</span>

    <span class="k">def</span> <span class="nf">getSegmentValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segment</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">segment</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">segment</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastSegment</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">segment</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastSegment</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastSegment</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internalGeneratorNextCall</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="n">segment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getSegmentValue</span><span class="p">()</span>
        <span class="n">step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStepValue</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">segment</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="n">segment</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span>
            <span class="k">if</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wraparound</span><span class="p">:</span>
                    <span class="n">position</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="n">position</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wraparound</span><span class="p">:</span>
                    <span class="n">position</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">completed</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">completed</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+=</span> <span class="n">step</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">next</span><span class="p">()</span></div>


<div class="viewcode-block" id="EventIndex"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventIndex">[docs]</a><span class="k">class</span> <span class="nc">EventIndex</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plays values from a list based on a position index.</span>

<span class="sd">    :Args:</span>

<span class="sd">        values: EventScale or list</span>
<span class="sd">            List of values to read. Values in list can be floats,</span>
<span class="sd">            PyoObject or other EventGenerator.</span>
<span class="sd">        index: int, PyoObject or EventGenerator</span>
<span class="sd">            Position to read in the list, starting at 0.</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of values to play. Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; scl = [5.00, 5.02, 5.03, 5.05, 5.07, 5.08, 5.10, 6.00]</span>
<span class="sd">    &gt;&gt;&gt; arp = EventSeq([0, 2, 4, 2, 1, 3, 5, 3, 1, 6, 4, 1])</span>
<span class="sd">    &gt;&gt;&gt; e = Events(degree = EventIndex(scl, arp), beat = 1/4., db = -6).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">occurrences</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">stopEventsWhenDone</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastIndex</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">stopEventsWhenDone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getIndexValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastIndex</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastIndex</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastIndex</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internalGeneratorNextCall</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getIndexValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="EventMarkov"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventMarkov">[docs]</a><span class="k">class</span> <span class="nc">EventMarkov</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies a Markov algorithm to a list of values.</span>

<span class="sd">    A Markov chain is a stochastic model describing a sequence of possible events</span>
<span class="sd">    in which the probability of each event depends only on the state attained in</span>
<span class="sd">    the previous events.</span>

<span class="sd">    :Args:</span>

<span class="sd">        values: EventScale or list</span>
<span class="sd">            Original list of values.</span>
<span class="sd">        order: int, PyoObject or EventGenerator, optional</span>
<span class="sd">            Order of the Markov chain, between 1 and 10. Determines how many past</span>
<span class="sd">            values will be used to build the probability table for the next note.</span>
<span class="sd">            Defaults to 2.</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of values to play. Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; jesus =  [67,69,71,74,72,72,76,74,74,79,78,79,74,71,67,69,71,72,74,76,74,72,71]</span>
<span class="sd">    &gt;&gt;&gt; jesus += [69,71,67,66,67,69,62,66,69,72,71,69,71,67,69,71,74,72,72,76,74,74,79]</span>
<span class="sd">    &gt;&gt;&gt; jesus += [78,79,74,71,67,69,71,64,74,72,71,69,67,62,67,66,67,71,74,79,74,71,67]</span>
<span class="sd">    &gt;&gt;&gt; e = Events(midinote=EventMarkov(jesus, 2), beat=1/4., db=-6).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">occurrences</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">stopEventsWhenDone</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastOrder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">stopEventsWhenDone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">markov</span> <span class="o">=</span> <span class="n">MarkovGen</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getOrderValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastOrder</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">order</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastOrder</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastOrder</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internalGeneratorNextCall</span><span class="p">()</span>

        <span class="n">order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOrderValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">markov</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">markov</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<span class="c1">###################</span>
<div class="viewcode-block" id="EventChoice"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventChoice">[docs]</a><span class="k">class</span> <span class="nc">EventChoice</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plays values randomly chosen from a list.</span>

<span class="sd">    :Args:</span>

<span class="sd">        values: EventScale or list</span>
<span class="sd">            List of possible values to read. Values in list can be floats,</span>
<span class="sd">            PyoObject or other EventGenerator.</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of values to play. Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; scl = [5.00, 5.02, 5.03, 5.05, 5.07, 5.08, 5.10, 6.00]</span>
<span class="sd">    &gt;&gt;&gt; e = Events(degree = EventChoice(scl), beat = 1/4., db = -6).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">occurrences</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">stopEventsWhenDone</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">stopEventsWhenDone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internalGeneratorNextCall</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="EventDrunk"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventDrunk">[docs]</a><span class="k">class</span> <span class="nc">EventDrunk</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a random walk over a list of values.</span>

<span class="sd">    A random walk is a stochastic process that consists of a succession of</span>
<span class="sd">    random steps, within a distance of +/- `maxStep` from the previous state.</span>

<span class="sd">    :Args:</span>

<span class="sd">        values: EventScale or list</span>
<span class="sd">            List of values to read. Values in list can be floats,</span>
<span class="sd">            PyoObject or other EventGenerator.</span>
<span class="sd">        maxStep: int, PyoObject or EventGenerator, optional</span>
<span class="sd">            Determine the larger step the walk can do between two successive</span>
<span class="sd">            events. A negative &#39;maxStep&#39; is the same but repetition are not</span>
<span class="sd">            allowed. Defaults to 2.</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of values to play. Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; scl = [5.00, 5.02, 5.03, 5.05, 5.07, 5.08, 5.10, 6.00]</span>
<span class="sd">    &gt;&gt;&gt; e = Events(degree=EventDrunk(scl, maxStep=-2), beat=1/4., db=-6).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">maxStep</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">occurrences</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">stopEventsWhenDone</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_values</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastMaxStep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span> <span class="o">=</span> <span class="n">maxStep</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">stopEventsWhenDone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowRepetition</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">getMaxStepValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastMaxStep</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxStep</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allowRepetition</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="o">-</span><span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allowRepetition</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastMaxStep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastMaxStep</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internalGeneratorNextCall</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="n">maxStep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getMaxStepValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">maxStep</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
            <span class="n">dev</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="n">maxStep</span><span class="p">,</span> <span class="n">maxStep</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">dev</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowRepetition</span><span class="p">:</span>
                <span class="n">dev</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="n">maxStep</span><span class="p">,</span> <span class="n">maxStep</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="n">dev</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="n">dev</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="o">-</span> <span class="n">dev</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="EventNoise"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventNoise">[docs]</a><span class="k">class</span> <span class="nc">EventNoise</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a random value between -1.0 and 1.0.</span>

<span class="sd">    EventNoise returns a random value between -1.0 and 1.0, based on one of</span>
<span class="sd">    three common noise generators, white, pink (1/f) and brown (1/f^2).</span>

<span class="sd">    :Args:</span>

<span class="sd">        type: int, optional</span>
<span class="sd">            The type of noise used to generate the random sequence. Available</span>
<span class="sd">            types are:</span>

<span class="sd">            0: white noise (default)</span>
<span class="sd">            1: pink noise</span>
<span class="sd">            2:brown noise</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of values to play. Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; scl = EventScale(&quot;C&quot;, &quot;aeolian&quot;, 4, 4)</span>
<span class="sd">    &gt;&gt;&gt; note = EventNoise(1).rescale(-1,1,48,84,1).snap(scl)</span>
<span class="sd">    &gt;&gt;&gt; e = Events(midinote=note, beat=1/4., db=-6).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">occurrences</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">stopEventsWhenDone</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">stopEventsWhenDone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c6</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">getTypeValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastType</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastType</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastType</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getTypeValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rnd</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">*</span> <span class="mf">0.99886</span> <span class="o">+</span> <span class="n">rnd</span> <span class="o">*</span> <span class="mf">0.0555179</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">*</span> <span class="mf">0.99332</span> <span class="o">+</span> <span class="n">rnd</span> <span class="o">*</span> <span class="mf">0.0750759</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span> <span class="o">*</span> <span class="mf">0.96900</span> <span class="o">+</span> <span class="n">rnd</span> <span class="o">*</span> <span class="mf">0.1538520</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c3</span> <span class="o">*</span> <span class="mf">0.86650</span> <span class="o">+</span> <span class="n">rnd</span> <span class="o">*</span> <span class="mf">0.3104856</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c4</span> <span class="o">*</span> <span class="mf">0.55000</span> <span class="o">+</span> <span class="n">rnd</span> <span class="o">*</span> <span class="mf">0.5329522</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c5</span> <span class="o">*</span> <span class="o">-</span><span class="mf">0.7616</span> <span class="o">-</span> <span class="n">rnd</span> <span class="o">*</span> <span class="mf">0.0168980</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c3</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c4</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">c6</span> <span class="o">+</span> <span class="n">rnd</span> <span class="o">*</span> <span class="mf">0.5362</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c6</span> <span class="o">=</span> <span class="n">rnd</span> <span class="o">*</span> <span class="mf">0.115926</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">val</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rnd</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">=</span> <span class="n">rnd</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">-</span> <span class="n">rnd</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.996</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y1</span> <span class="o">*</span> <span class="mf">20.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<span class="c1">###################</span>
<div class="viewcode-block" id="EventCall"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventCall">[docs]</a><span class="k">class</span> <span class="nc">EventCall</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calls a function, with any number of arguments, and uses its return value.</span>

<span class="sd">    EventCall can call any function (built-in, from a module or user-defined)</span>
<span class="sd">    and use its return as the value for the Events&#39;s parameter where it is used.</span>
<span class="sd">    The function *must* return a single number.</span>

<span class="sd">    :Args:</span>

<span class="sd">        function: callable</span>
<span class="sd">            The function to call, which should return the value to use.</span>
<span class="sd">        args: int, PyoObject or EventGenerator, optional</span>
<span class="sd">            Any number of arguments to pass to the function call. If given a</span>
<span class="sd">            PyoObject or an EventGenerator, these will be resolved for each</span>
<span class="sd">            event and the result passed, as number, to the function.</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of values to play. Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; from random import randrange</span>
<span class="sd">    &gt;&gt;&gt; e = Events(midinote=EventCall(randrange, 48, 72, 3), beat=1/4., db=-6).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;occurrences&quot;</span><span class="p">,</span> <span class="n">inf</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;stopEventsWhenDone&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">generator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internalGeneratorNextCall</span><span class="p">()</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
                <span class="n">arg</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">args</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<span class="c1">###################</span>
<div class="viewcode-block" id="EventConditional"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.EventConditional">[docs]</a><span class="k">class</span> <span class="nc">EventConditional</span><span class="p">(</span><span class="n">EventGenerator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Executes one generator or the other depending on the result of a condition.</span>

<span class="sd">    EventConditional takes three values or generators as arguments and if the</span>
<span class="sd">    value of `condition` is True (anything that python considers True), the</span>
<span class="sd">    `iftrue` argument is used to produce the value for the event, otherwise</span>
<span class="sd">    th `iffalse` argument is used.</span>

<span class="sd">    :Args:</span>

<span class="sd">        condition: int, PyoObject or EventGenerator</span>
<span class="sd">            Conditional value. True for everything python considers True.</span>
<span class="sd">        iftrue: int, PyoObject or EventGenerator</span>
<span class="sd">            Output value if the condition is True.</span>
<span class="sd">        iffalse: int, PyoObject or EventGenerator</span>
<span class="sd">            Output value if the condition is False.</span>
<span class="sd">        occurrences: int, optional</span>
<span class="sd">            Number of values to play. Defaults to inf (infinite).</span>
<span class="sd">        stopEventsWhenDone: bool, optional</span>
<span class="sd">            If True, the Events playback will stop if this generator reaches</span>
<span class="sd">            its end. If False, the Events will ignore this signal and probably</span>
<span class="sd">            get None as value for the given parameter. It&#39;s the user</span>
<span class="sd">            responsability to handle this case correctly. Defaults to True.</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; from random import randrange</span>
<span class="sd">    &gt;&gt;&gt; scl = EventScale(&quot;C&quot;, &quot;aeolian&quot;, 4, 3)</span>
<span class="sd">    &gt;&gt;&gt; bit = EventChoice([0, 1, 1, 1])</span>
<span class="sd">    &gt;&gt;&gt; pittrue = EventSlide(scl, segment=3, step=1, startpos=0)</span>
<span class="sd">    &gt;&gt;&gt; veltrue = EventDrunk(range(64, 127), maxStep=5)</span>
<span class="sd">    &gt;&gt;&gt; pit = EventConditional(bit, pittrue, 0)</span>
<span class="sd">    &gt;&gt;&gt; vel = EventConditional(bit, veltrue, 0)</span>
<span class="sd">    &gt;&gt;&gt; e = Events(midinote=pit, beat=1/4., midivel=vel).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">iftrue</span><span class="p">,</span> <span class="n">iffalse</span><span class="p">,</span> <span class="n">occurrences</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">stopEventsWhenDone</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">EventGenerator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iftrue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">iftrue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iffalse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_generator</span><span class="p">(</span><span class="n">iffalse</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inspect_occurrences</span><span class="p">(</span><span class="n">occurrences</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span> <span class="o">=</span> <span class="n">stopEventsWhenDone</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span>

    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastCondition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastIftrue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastIffalse</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">getConditionValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastCondition</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastCondition</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastCondition</span>

    <span class="k">def</span> <span class="nf">getIftrueValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iftrue</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iftrue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iftrue</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iftrue</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iftrue</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastIftrue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iftrue</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastIftrue</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastIftrue</span>

    <span class="k">def</span> <span class="nf">getIffalseValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iffalse</span><span class="p">,</span> <span class="n">PyoObject</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iffalse</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iffalse</span><span class="p">,</span> <span class="n">EventGenerator</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">iffalse</span><span class="o">.</span><span class="n">setMaster</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iffalse</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastIffalse</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iffalse</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lastIffalse</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastIffalse</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">condition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getConditionValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">condition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">occurrences</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">condition</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getIftrueValue</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getIffalseValue</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkValueTypeAndIncrementCount</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<span class="c1"># Event Player</span>
<span class="c1">##############</span>
<div class="viewcode-block" id="Events"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.Events">[docs]</a><span class="k">class</span> <span class="nc">Events</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sequencing user-defined events to form musical phrases.</span>

<span class="sd">    The Events object is the primary tool in the events framework. It uses</span>
<span class="sd">    generators (derived from EventGenerator) as value for its arguments to</span>
<span class="sd">    build a sequence of events, each of them with their own parameters.</span>

<span class="sd">    Each time Events needs to produce a new event, it collects values from</span>
<span class="sd">    the generators given to its arguments, builds a parameter dictionary</span>
<span class="sd">    and gives it to a new instance of the audio instrument referenced to</span>
<span class="sd">    its &#39;instr&#39; argument.</span>

<span class="sd">    The object produces new events until one of its generators reaches the</span>
<span class="sd">    end of its sequence.</span>

<span class="sd">    Events is a child of the dictionary class, which means that every argument</span>
<span class="sd">    given at its initialization will become a new key (with its associated</span>
<span class="sd">    value) in its memory. These keys will serve to create the parameter</span>
<span class="sd">    dictionary passed to the audio instrument instance playing this event.</span>
<span class="sd">    Inside the instrument instance, the value associated to these keys will</span>
<span class="sd">    be retrieved as instance&#39;s attributes, with the syntax self.key_name.</span>

<span class="sd">    The user can create as many new keys as needed to control its instrument,</span>
<span class="sd">    but there is already a number of pre-defined keys for which Events will</span>
<span class="sd">    do some processing and build useful parameters. Here is the list, grouped</span>
<span class="sd">    by themes, of pre-defined keys to overwrite:</span>

<span class="sd">    **Instrument**</span>
<span class="sd">        - instr: class, optional</span>
<span class="sd">            Reference to a custom class with which the events will be played.</span>
<span class="sd">            Defaults to DefaultInstrument.</span>
<span class="sd">        - signal: string, optional</span>
<span class="sd">            Name of the attribute in the instrument defintion retrieved as the</span>
<span class="sd">            output signal of the Events object. The sig() method returns the</span>
<span class="sd">            sum, as an audio signal, of all active instances. This can be useful</span>
<span class="sd">            to do post-processing on the signal produced by the events. Defaults</span>
<span class="sd">            to None.</span>

<span class="sd">    **Constants**</span>
<span class="sd">        - bpm: int, optional</span>
<span class="sd">            Beat-Per-Minute value used by the `beat` key to compute event&#39;s duration.</span>
<span class="sd">            Defaults to 120.</span>
<span class="sd">        - outs: int, optional</span>
<span class="sd">            Number of output channels in the audio signal returned by the sig() method.</span>
<span class="sd">            This value should match the number of audio streams produced by the instrument.</span>
<span class="sd">            Defaults to 2.</span>

<span class="sd">    **Duration keys**</span>
<span class="sd">        - dur: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Duration, in seconds, before the next event. Defaults to 1.</span>
<span class="sd">        - beat: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Duration, in beat value, before the next event (1 beat = quarter note at BPM).</span>
<span class="sd">            If defined, this value will be used to compute the duration in seconds for the</span>
<span class="sd">            `dur` key. Defaults to None.</span>
<span class="sd">        - durmul: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Event duration multiplier (only affects the duration of the event&#39;s lifetime,</span>
<span class="sd">            not the time to wait before the next event). Defaults to 1.</span>
<span class="sd">        - tail: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Duration, in seconds, to wait before deleting the instrument&#39;s instance when</span>
<span class="sd">            its envelope has ended. Useful to let a reverb tail to finish before cleaning-up</span>
<span class="sd">            the instance. Defaults to 2.</span>

<span class="sd">    **Amplitude keys**</span>
<span class="sd">        - amp: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Linear gain for the event (1 is nominal gain). Defaults to 0.7.</span>
<span class="sd">        - dB: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Gain, in decibels, for the event. If defined, this value will be used to compute</span>
<span class="sd">            the linear gain for the `amp` key. Defaults to None.</span>
<span class="sd">        - midivel: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Midi velocity, between 0 and 127, for the event. If defined, this value will be</span>
<span class="sd">            used to compute the linear gain for the `amp` key. Defaults to None.</span>

<span class="sd">    **Envelope keys**</span>
<span class="sd">        - envelope: PyoTableObject, optional</span>
<span class="sd">            User-defined envelope as a PyoTableObject. If defined, this will be the envelope</span>
<span class="sd">            created for the event. Defaults to None.</span>
<span class="sd">        - attack: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Rising time, in seconds, of an ASR or ADSR envelope. This envelope is created if</span>
<span class="sd">            `envelope` is None. Defaults to 0.005.</span>
<span class="sd">        - decay: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            If defined, its the decay time, in seconds, of an ADSR envelope, otherwise the</span>
<span class="sd">            envelope will be an ASR (Attack - Sustain - Release). Defaults to None.</span>
<span class="sd">        - sustain: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Sustain linear gain of an ADSR or ASR envelope. Defaults to 0.7.</span>
<span class="sd">        - release: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Release time, in seconds, of an ASR or ADSR envelope. This envelope is created if</span>
<span class="sd">            `envelope` is None. Defaults to 0.05.</span>

<span class="sd">    **Pitch keys**</span>
<span class="sd">        - freq: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Frequency, in cycle per seconds, for the event. Defaults to 250.</span>
<span class="sd">        - midinote: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Midi pitch, between 0 and 127, for the event. If defined, this value will be used</span>
<span class="sd">            to compute the frequency in cycles per second for the `freq` key. Defaults to None.</span>
<span class="sd">        - degree: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Octave.degree pitch notation (ex.: 6.00, 6.04, 6.07). If defined, this value will be</span>
<span class="sd">            used to compute the frequency in cycles per second for the `freq` key. Defaults to None.</span>
<span class="sd">        - transpo: float, PyoObject or EventGenerator, optional</span>
<span class="sd">            Transposition, in midi note value (-12 is an octave lower), automatically computed in</span>
<span class="sd">            the value of the `freq` key. Defaults to 0.</span>

<span class="sd">    **Ending keys**</span>
<span class="sd">        - atend: python callable, optional</span>
<span class="sd">            If defined, a function to call when all events are played. This can be useful to sequence</span>
<span class="sd">            multiple Events objects. Defaults to None</span>

<span class="sd">    &gt;&gt;&gt; s = Server().boot()</span>
<span class="sd">    &gt;&gt;&gt; s.start()</span>
<span class="sd">    &gt;&gt;&gt; env = CosTable([(0,0.0),(64,1.0),(8191,0.0)])</span>
<span class="sd">    &gt;&gt;&gt; scl = EventScale(root=&quot;C&quot;, scale=&quot;egyptian&quot;, first=4, octaves=3)</span>
<span class="sd">    &gt;&gt;&gt; seg = RandInt(max=6, freq=0.5)</span>
<span class="sd">    &gt;&gt;&gt; step = RandInt(max=6, freq=0.75, add=-3)</span>
<span class="sd">    &gt;&gt;&gt; note = EventSlide(scl, seg, step)</span>
<span class="sd">    &gt;&gt;&gt; e = Events(midinote=note, beat=1/4., db=[-3, -9, -9], envelope=env, durmul=1.25).play()</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="c1"># Instrument key</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;instr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DefaultInstrument</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Constant keys</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;bpm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">120</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;outs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="c1"># Duration keys</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;dur&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;beat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;durmul&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;tail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="c1"># Amplitude keys</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;amp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;midivel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Envelope keys</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;envelope&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;attack&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.005</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;decay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;sustain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;release&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.05</span>
        <span class="c1"># Pitch keys</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">250</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;midinote&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;degree&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;transpo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># Ending keys</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;atend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">instanceId</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxInstanceId</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">31</span>

        <span class="c1"># Add user-supplied arguments as dict attributes.</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">callNextEvent</span> <span class="o">=</span> <span class="n">Pattern</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_processEvent</span><span class="p">)</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">Sig</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;outs&quot;</span><span class="p">])</span>

<div class="viewcode-block" id="Events.events"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.Events.events">[docs]</a>    <span class="k">def</span> <span class="nf">events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Return a copy of this Events object. &quot;&quot;&quot;</span>
        <span class="n">evts</span> <span class="o">=</span> <span class="n">Events</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">evts</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">evts</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">attr</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">evts</span></div>

<div class="viewcode-block" id="Events.play"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.Events.play">[docs]</a>    <span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dur</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Start the events playback.</span>

<span class="sd">        This method returns `self`, allowing it to be applied at the object</span>
<span class="sd">        creation.</span>

<span class="sd">        :Args:</span>

<span class="sd">            dur: float, optional</span>
<span class="sd">                Duration, in seconds, of the object&#39;s activation. The default</span>
<span class="sd">                is 0 and means infinite duration.</span>
<span class="sd">            delay: float, optional</span>
<span class="sd">                Delay, in seconds, before the object&#39;s activation. Defaults to 0.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;instr&quot;</span><span class="p">],</span> <span class="n">EventInstrument</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;`instr` argument must be a sub-class of EventInstrument...&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;... Events is using DefaultInstrument!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;instr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DefaultInstrument</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actives</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">callAtEnd</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;atend&quot;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callAtEnd</span> <span class="o">=</span> <span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;atend&quot;</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;instr&quot;</span><span class="p">,</span> <span class="s2">&quot;signal&quot;</span><span class="p">,</span> <span class="s2">&quot;bpm&quot;</span><span class="p">,</span> <span class="s2">&quot;outs&quot;</span><span class="p">,</span> <span class="s2">&quot;atend&quot;</span><span class="p">]]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">PyoObjectBase</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">type</span><span class="p">([]),</span> <span class="nb">type</span><span class="p">(())]:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EventSeq</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)]:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">EventSeq</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">resetEmbeddedGenerator</span><span class="p">()</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">callNextEvent</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">dur</span><span class="o">=</span><span class="n">dur</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="Events.stop"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.Events.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stop the events playback.</span>

<span class="sd">        :Args:</span>

<span class="sd">            wait: float, optional</span>
<span class="sd">                Delay, in seconds, before the process is actually stopped.</span>
<span class="sd">                Defaults to 0.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">callNextEvent</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="n">wait</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">getCurrentDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span>

<div class="viewcode-block" id="Events.sig"><a class="viewcode-back" href="../../../api/classes/events.html#pyo.Events.sig">[docs]</a>    <span class="k">def</span> <span class="nf">sig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the audio output signal (sum of all active instances), if defined.</span>

<span class="sd">        The audio output signal of an Events object is the sum of the active</span>
<span class="sd">        instrument instances&#39;s attribute whose name is the same as given to</span>
<span class="sd">        the &#39;signal&#39; key. The number of audio streams in the output signal is</span>
<span class="sd">        determined by the value for the key &#39;outs&#39;, it should match the number</span>
<span class="sd">        of audio streams produced by the instrument.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span></div>

    <span class="k">def</span> <span class="nf">_processEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create instrument instances and add them to the active list.&quot;&quot;&quot;</span>

        <span class="n">quarterDur</span> <span class="o">=</span> <span class="mf">60.0</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;bpm&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;removeFunction&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_remove</span><span class="p">,</span>
            <span class="s2">&quot;bpm&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;bpm&quot;</span><span class="p">],</span>
            <span class="s2">&quot;outs&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;outs&quot;</span><span class="p">],</span>
            <span class="s2">&quot;instanceId&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">instanceId</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="c1"># Compute time before next event and current event&#39;s duration.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;beat&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nextBeat</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;beat&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nextBeat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nextDurMul</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;durmul&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nextDurMul</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">timeBeforeNextEvent</span> <span class="o">=</span> <span class="n">quarterDur</span> <span class="o">*</span> <span class="n">nextBeat</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;dur&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timeBeforeNextEvent</span> <span class="o">*</span> <span class="n">nextDurMul</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nextDur</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;dur&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nextDur</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nextDurMul</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;durmul&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nextDurMul</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">timeBeforeNextEvent</span> <span class="o">=</span> <span class="n">nextDur</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;dur&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">timeBeforeNextEvent</span> <span class="o">*</span> <span class="n">nextDurMul</span>

        <span class="k">if</span> <span class="s2">&quot;dur&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callNextEvent</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callNextEvent</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">timeBeforeNextEvent</span>

        <span class="n">ending</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Process event&#39;s every other attributes.</span>
        <span class="n">proscribe</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dur&quot;</span><span class="p">,</span> <span class="s2">&quot;beat&quot;</span><span class="p">,</span> <span class="s2">&quot;instr&quot;</span><span class="p">,</span> <span class="s2">&quot;bpm&quot;</span><span class="p">,</span> <span class="s2">&quot;outs&quot;</span><span class="p">,</span> <span class="s2">&quot;midinote&quot;</span><span class="p">,</span> <span class="s2">&quot;degree&quot;</span><span class="p">,</span> <span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="s2">&quot;midivel&quot;</span><span class="p">,</span> <span class="s2">&quot;atend&quot;</span><span class="p">,</span> <span class="s2">&quot;signal&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">proscribe</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&quot;freq&quot;</span><span class="p">:</span>
                <span class="n">transpo</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;transpo&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">,</span> <span class="n">valueIfNone</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">transpo</span> <span class="o">=</span> <span class="n">midiToTranspo</span><span class="p">(</span><span class="n">transpo</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;transpo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">transpo</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;midinote&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">midiNote</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;midinote&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">midiNote</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;midinote&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midiNote</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midiToHz</span><span class="p">(</span><span class="n">midiNote</span><span class="p">)</span> <span class="o">*</span> <span class="n">transpo</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;midinote&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                        <span class="n">ending</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;degree&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">degree</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;degree&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">degree</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">midiNote</span> <span class="o">=</span> <span class="n">degreeToMidiNote</span><span class="p">(</span><span class="n">degree</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;midinote&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midiNote</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midiToHz</span><span class="p">(</span><span class="n">midiNote</span><span class="p">)</span> <span class="o">*</span> <span class="n">transpo</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;degree&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                        <span class="n">ending</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">freq</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;freq&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">freq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">transpo</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;freq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                        <span class="n">ending</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">arg</span> <span class="o">==</span> <span class="s2">&quot;amp&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">db</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;db&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">db</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">db</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;amp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">db</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                        <span class="n">ending</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;midivel&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">midivel</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;midivel&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">midivel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">midivel</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">midivel</span><span class="p">,</span> <span class="mi">127</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;midivel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midivel</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;amp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">midivel</span> <span class="o">/</span> <span class="mf">127.0</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;midivel&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                        <span class="n">ending</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">amp</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;amp&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">amp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="s2">&quot;amp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">amp</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;amp&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                        <span class="n">ending</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">getValueFromAttribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span><span class="o">.</span><span class="n">stopEventsWhenDone</span><span class="p">:</span>
                    <span class="n">ending</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">ending</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">callAtEnd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">callAtEnd</span><span class="o">.</span><span class="n">play</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">callNextEvent</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actives</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">instanceId</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;instr&quot;</span><span class="p">](</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">currentDict</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="nb">getattr</span><span class="p">(</span><span class="n">instr</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">])</span>
                        <span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actives</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instr</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">])</span>
                    <span class="p">]</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">instanceId</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">instanceId</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxInstanceId</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instanceId</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instanceId</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Removes an instrument instance from the active list. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">instanceId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actives</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">actives</span><span class="p">[</span><span class="n">instanceId</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">instr</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">])</span> <span class="k">for</span> <span class="n">instr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">actives</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instr</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;signal&quot;</span><span class="p">])]</span>
            <span class="p">)</span></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="../../../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Olivier Blanger.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>